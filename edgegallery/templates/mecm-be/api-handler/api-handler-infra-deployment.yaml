{{- if .Values.mecm.enabled }}
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    kompose.cmd: kompose convert
    kompose.version: 1.16.0 (0c01309)
  creationTimestamp: null
  labels:
    io.kompose.service: api-handler-infra
  name: api-handler-infra
spec:
  selector:
    matchLabels:
      io.kompose.service: api-handler-infra
  replicas: 1
  strategy:
    type: Recreate
  template:
    metadata:
      creationTimestamp: null
      labels:
        io.kompose.service: api-handler-infra
    spec:
      containers:
      - args:
        - /app/start-app.sh
        env:
        - name: APP
          value: api-handler-infra
        - name: AUTH_MODULE_ENDPOINT
          value: 159.138.61.155:8067
        - name: DB_ADMIN_PASSWORD
          value: so_Admin123
        - name: DB_ADMIN_USERNAME
          value: so_admin
        - name: DB_HOST
          value: mariadb
        - name: DB_PASSWORD
          value: so_Admin123
        - name: DB_PORT
          value: "3306"
        - name: DB_USERNAME
          value: so_admin
        - name: JVM_ARGS
          value: -Xms64m -Xmx512m
        image: {{ if eq .Values.arch "arm64" }}{{ .Values.images.api_handler_infra.arm64 }}{{- else  }}{{.Values.images.api_handler_infra.x86}}{{- end  }}
        name: api-handler-infra
        ports:
        - containerPort: 8080
        resources: {}
        volumeMounts:
        - mountPath: /app/ca-certificates
          name: api-handler-infra-claim0
        - mountPath: /app/config
          name: api-handler-infra-claim1
      hostname: "api-handler-infra-so-testlab-onap-org"
      restartPolicy: Always
      volumes:
      - name: api-handler-infra-claim0
        persistentVolumeClaim:
          claimName: common-ca-certificates-pv-claim0
      - name: api-handler-infra-claim1
        persistentVolumeClaim:
          claimName: api-handler-infra-claim1
status: {}
{{- end }}